import sctools.core as sc


def phi_rect_approx(r):
    return (
        1
        + 0.2284732905 * (r - 1)
        - 0.08813662302 * (r - 1) ** 2
        + 0.04827946003 * (r - 1) ** 3
        - 0.03127277573 * (r - 1) ** 4
        + 0.02241699206 * (r - 1) ** 5
        - 0.01718041161 * (r - 1) ** 6
        + 0.01379141315 * (r - 1) ** 7
        - 0.01144586284 * (r - 1) ** 8
        + 0.009737374309 * (r - 1) ** 9
        - 0.008442674960 * (r - 1) ** 10
        + 0.007430490326 * (r - 1) ** 11
        - 0.006619174911 * (r - 1) ** 12
        + 0.005955504769 * (r - 1) ** 13
        - 0.005403384294 * (r - 1) ** 14
        + 0.004937503063 * (r - 1) ** 15
    )


def inv_phi_rect_approx(r):

    return (
        1.0
        + 4.376879230452952 * (r - 1)
        + 7.390096283758735 * (r - 1) ** 2
        + 7.237219471534163 * (r - 1) ** 3
        + 5.991576168110211 * (r - 1) ** 4
        + 3.728577509035313 * (r - 1) ** 5
        + 1.7396270463685406 * (r - 1) ** 6
        + 1.1543413391162676 * (r - 1) ** 7
        + 0.04250082824813188 * (r - 1) ** 8
        + 0.3292792774810219 * (r - 1) ** 9
        - 0.002590010314452334 * (r - 1) ** 10
        - 0.16126267764293367 * (r - 1) ** 11
        + 0.36744094492367263 * (r - 1) ** 12
        - 0.4756371436446193 * (r - 1) ** 13
        + 0.4626527213655051 * (r - 1) ** 14
        - 0.3114696848504541 * (r - 1) ** 15
    )


def check_phi_approx(x=0.8, n=20, tau1=0.5, tau2=0.5, tau3=0.5):

    coeffs = sc.phi_series_coeffs(n, tau1, tau2, tau3)

    phi_approx = sc.phi_series(x, coeffs)

    print(phi_approx)
    print(sc.phi(x, tau1, tau2, tau3))
